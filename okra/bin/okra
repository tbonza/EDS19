#! /usr/bin/env python

import argparse
import logging

from okra.logging_utils import enable_log
from okra.playbook import load_playbook, parse_playbook
from okra.worker import redis_worker

logger = logging.getLogger(__name__)

parser = argparse.ArgumentParser()
parser.add_argument("--redis", help="start redis worker")
parser.add_argument("--logfile", help="filepath to log file")

args = parser.parse_args()

if args.logfile:
    enable_log(args.logfile)

if args.redis:
    logger.info("STARTED redis worker")
    redis_worker(job=args.redis)
    logger.info("FINISHED redis worker")

else:
    parser.print_help()
    
